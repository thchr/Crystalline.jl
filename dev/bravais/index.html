<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bravais types &amp; bases · Crystalline.jl</title><meta name="title" content="Bravais types &amp; bases · Crystalline.jl"/><meta property="og:title" content="Bravais types &amp; bases · Crystalline.jl"/><meta property="twitter:title" content="Bravais types &amp; bases · Crystalline.jl"/><meta name="description" content="Documentation for Crystalline.jl."/><meta property="og:description" content="Documentation for Crystalline.jl."/><meta property="twitter:description" content="Documentation for Crystalline.jl."/><meta property="og:url" content="https://thchr.github.io/Crystalline.jl/bravais/"/><meta property="twitter:url" content="https://thchr.github.io/Crystalline.jl/bravais/"/><link rel="canonical" href="https://thchr.github.io/Crystalline.jl/bravais/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.svg" alt="Crystalline.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="Crystalline.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Crystalline.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../operations/">Symmetry operations</a></li><li><a class="tocitem" href="../groups/">Groups</a></li><li><a class="tocitem" href="../irreps/">Irreps</a></li><li class="is-active"><a class="tocitem" href>Bravais types &amp; bases</a><ul class="internal"><li><a class="tocitem" href="#API"><span>API</span></a></li><li><a class="tocitem" href="#Crystalline.jl-extensions-of-Bravais.jl-functions"><span>Crystalline.jl extensions of Bravais.jl functions</span></a></li></ul></li><li><a class="tocitem" href="../bandreps/">Band representations</a></li><li><a class="tocitem" href="../lattices/">Lattices</a></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../internal-api/">Internal API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Bravais types &amp; bases</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bravais types &amp; bases</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/thchr/Crystalline.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/thchr/Crystalline.jl/blob/master/docs/src/bravais.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Bravais.jl"><a class="docs-heading-anchor" href="#Bravais.jl">Bravais.jl</a><a id="Bravais.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Bravais.jl" title="Permalink"></a></h1><p>Bravais types, basis systems, and transformations between conventional and primitive settings.</p><h2 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h2><h3 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.AbstractBasis" href="#Bravais.AbstractBasis"><code>Bravais.AbstractBasis</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractBasis &lt;: StaticVector{D, SVector{D, E}}</code></pre><p>Abstract supertype of a <code>D</code>-dimensional basis in <code>D</code>-dimensional space with coordinate values of type <code>E</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/types.jl#L2-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.DirectBasis" href="#Bravais.DirectBasis"><code>Bravais.DirectBasis</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DirectBasis{D, E} &lt;: AbstractBasis{D, E}</code></pre><p>A wrapper type over <code>D</code> distinct <code>D</code>-dimensional vectors (given as a <code>SVector{D, SVector{D, E}}</code>), defining a lattice basis in direct space. By default (i.e., if omitted), <code>E</code> is <code>Float64</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/types.jl#L12-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.ReciprocalBasis" href="#Bravais.ReciprocalBasis"><code>Bravais.ReciprocalBasis</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ReciprocalBasis{D, E} &lt;: AbstractBasis{D, E}</code></pre><p>A wrapper type over <code>D</code> distinct <code>D</code>-dimensional vectors (given as a <code>SVector{D, SVector{D, E}}</code>), defining a lattice basis in reciprocal space. By default (i.e., if omitted), <code>E</code> is <code>Float64</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/types.jl#L12-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.AbstractPoint" href="#Bravais.AbstractPoint"><code>Bravais.AbstractPoint</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractPoint{D, T} &lt;: StaticVector{D, T}</code></pre><p>Abstract supertype of a <code>D</code>-dimensional point with elements of type <code>T</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/types.jl#L131-L135">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.DirectPoint" href="#Bravais.DirectPoint"><code>Bravais.DirectPoint</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DirectPoint{D} &lt;: AbstractPoint{D}</code></pre><p>A wrapper type over an <code>SVector{D, Float64}</code>, defining a single point in <code>D</code>-dimensional direct space. </p><p>The coordinates of a DirectPoint are generally assumed specified relative to an associated DirectBasis. To convert to Cartesian coordinates, see <a href="#Bravais.cartesianize"><code>cartesianize</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/types.jl#L148-L156">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.ReciprocalPoint" href="#Bravais.ReciprocalPoint"><code>Bravais.ReciprocalPoint</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ReciprocalPoint{D} &lt;: AbstractPoint{D}</code></pre><p>A wrapper type over an <code>SVector{D, Float64}</code>, defining a single point in <code>D</code>-dimensional reciprocal space. </p><p>The coordinates of a ReciprocalPoint are generally assumed specified relative to an associated ReciprocalBasis. To convert to Cartesian coordinates, see <a href="#Bravais.cartesianize"><code>cartesianize</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/types.jl#L148-L156">source</a></section></article><h3 id="Crystal-systems-and-Bravais-types"><a class="docs-heading-anchor" href="#Crystal-systems-and-Bravais-types">Crystal systems &amp; Bravais types</a><a id="Crystal-systems-and-Bravais-types-1"></a><a class="docs-heading-anchor-permalink" href="#Crystal-systems-and-Bravais-types" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.crystalsystem" href="#Bravais.crystalsystem"><code>Bravais.crystalsystem</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">crystalsystem(Rs::DirectBasis{D})  --&gt;  String
crystalsystem(Gs::ReciprocalBasis{D})  --&gt;  String</code></pre><p>Determine the crystal system of a point lattice with <code>DirectBasis</code> <code>Rs</code>, assuming the conventional setting choice defined in the International Tables of Crystallography <sup class="footnote-reference"><a id="citeref-ITA6" href="#footnote-ITA6">[ITA6]</a></sup>.</p><p>If a <code>ReciprocalBasis</code> <code>Gs</code> is provided for the associated reciprocal point lattice, the crystal system is determined by first transforming to the direct lattice.</p><p>There are 4 crystal systems in 2D and 7 in 3D (see Section 2.1.2(iii) of <sup class="footnote-reference"><a id="citeref-ITA5" href="#footnote-ITA5">[ITA5]</a></sup>):</p><table><tr><th style="text-align: left"><code>D</code></th><th style="text-align: right">System</th><th style="text-align: right">Conditions</th><th style="text-align: right">Free parameters</th></tr><tr><td style="text-align: left"><strong>1D</strong></td><td style="text-align: right">linear</td><td style="text-align: right">none</td><td style="text-align: right">a</td></tr><tr><td style="text-align: left"><strong>2D</strong></td><td style="text-align: right">square</td><td style="text-align: right">a=b &amp; γ=90°</td><td style="text-align: right">a</td></tr><tr><td style="text-align: left"></td><td style="text-align: right">rectangular</td><td style="text-align: right">γ=90°</td><td style="text-align: right">a,b</td></tr><tr><td style="text-align: left"></td><td style="text-align: right">hexagonal</td><td style="text-align: right">a=b &amp; γ=120°</td><td style="text-align: right">a</td></tr><tr><td style="text-align: left"></td><td style="text-align: right">oblique</td><td style="text-align: right">none</td><td style="text-align: right">a,b,γ</td></tr><tr><td style="text-align: left"><strong>3D</strong></td><td style="text-align: right">cubic</td><td style="text-align: right">a=b=c &amp; α=β=γ=90°</td><td style="text-align: right">a</td></tr><tr><td style="text-align: left"></td><td style="text-align: right">hexagonal</td><td style="text-align: right">a=b &amp; α=β=90° &amp; γ=120°</td><td style="text-align: right">a,c</td></tr><tr><td style="text-align: left"></td><td style="text-align: right">trigonal</td><td style="text-align: right">a=b &amp; α=β=90° &amp; γ=120°</td><td style="text-align: right">a,c (a,α for hR)</td></tr><tr><td style="text-align: left"></td><td style="text-align: right">tetragonal</td><td style="text-align: right">a=b &amp; α=β=γ=90°</td><td style="text-align: right">a,c</td></tr><tr><td style="text-align: left"></td><td style="text-align: right">orthorhombic</td><td style="text-align: right">α=β=γ=90°</td><td style="text-align: right">a,b,c</td></tr><tr><td style="text-align: left"></td><td style="text-align: right">monoclinic</td><td style="text-align: right">α=γ=90°</td><td style="text-align: right">a,b,c,β≥90°</td></tr><tr><td style="text-align: left"></td><td style="text-align: right">triclinic</td><td style="text-align: right">none</td><td style="text-align: right">a,b,c,α,β,γ</td></tr></table><p>The <code>Rs</code> must specify a set of conventional basis vectors, i.e., not generally primitive. For primitive basis vectors, the crystal system can be further reduced into 5 Bravais types in 2D and 14 in 3D (see <a href="#Bravais.bravaistype"><code>bravaistype</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/systems.jl#L85-L121">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.bravaistype" href="#Bravais.bravaistype"><code>Bravais.bravaistype</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bravaistype(sgnum::Integer, D::Integer=3; normalize::Bool=false)  --&gt;  String</code></pre><p>Return the Bravais type of <code>sgnum</code> in dimension <code>D</code> as a string (as the concatenation of the single-character crystal abbreviation and the centering type).</p><p><strong>Keyword arguments</strong></p><ul><li><p><strong><code>normalize</code>:</strong> If the centering type associated with <code>sgnum</code> is <code>&#39;A&#39;</code>, we can choose (depending on the keyword argument <code>normalize</code>, defaulting to <code>false</code>) to &quot;normalize&quot; to the centering type <code>&#39;C&#39;</code>, since the difference between <code>&#39;A&#39;</code> and <code>&#39;C&#39;</code> centering only amounts to a basis change. With <code>normalize=true</code> we then have only the canonical 14 Bravais type, i.e.  <code>unique(bravaistype.(1:230, 3), normalize=true)</code> returns only 14 distinct types, rather than 15.</p><p>This only affects space groups 38-41 (normalizing their conventional Bravais types from <code>&quot;oA&quot;</code> to <code>&quot;oC&quot;</code>).</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/systems.jl#L326-L344">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.centering" href="#Bravais.centering"><code>Bravais.centering</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">centering(g::AbstractGroup) --&gt; Char</code></pre><p>Return the conventional centering type of a group. </p><p>For groups without lattice structure (e.g., point groups), return <code>nothing</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/src/notation.jl#L38-L45">source</a></section><section><div><pre><code class="language-julia hljs">centering(sgnum::Integer, D::Integer=3)  --&gt;  Char</code></pre><p>Return the conventional centering type <code>cntr</code> of the space group with number <code>sgnum</code> and dimension <code>D</code>.</p><p>The centering type is equal to the first letter of the Hermann-Mauguin notation&#39;s label, i.e., <code>centering(sgnum, D) == first(Crystalline.iuc(sgnum, D))</code>. Equivalently, the centering type is the second and last letter of the Bravais type (<a href="#Bravais.bravaistype"><code>bravaistype</code></a>), i.e., <code>centering(sgnum, D) == bravaistype(sgnum, D)</code>.</p><p>Possible values of <code>cntr</code>, depending on dimensionality <code>D</code>, are (see ITA Sec. 9.1.4):</p><ul><li><code>D = 1</code>:<ul><li><code>cntr = &#39;p&#39;</code>: no centering (primitive)</li></ul></li><li><code>D = 2</code>:<ul><li><code>cntr = &#39;p&#39;</code>: no centring (primitive)</li><li><code>cntr = &#39;c&#39;</code>: face centered</li></ul></li><li><code>D = 3</code>: <ul><li><code>cntr = &#39;P&#39;</code>: no centring (primitive)</li><li><code>cntr = &#39;I&#39;</code>: body centred (innenzentriert)</li><li><code>cntr = &#39;F&#39;</code>: all-face centred</li><li><code>cntr = &#39;A&#39;</code> or <code>&#39;C&#39;</code>: one-face centred, (b,c) or (a,b)</li><li><code>cntr = &#39;R&#39;</code>: hexagonal cell rhombohedrally centred</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/systems.jl#L366-L390">source</a></section></article><h3 id="Basis-construction"><a class="docs-heading-anchor" href="#Basis-construction">Basis construction</a><a id="Basis-construction-1"></a><a class="docs-heading-anchor-permalink" href="#Basis-construction" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.crystal" href="#Bravais.crystal"><code>Bravais.crystal</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">crystal(a, b, c, α, β, γ)  --&gt;  DirectBasis{3}</code></pre><p>Calculate basis vectors <span>$\mathbf{R}_1$</span>, <span>$\mathbf{R}_2$</span>, <span>$\mathbf{R}_3$</span> in a 3D Cartesian basis for a right-handed coordinate system with specified basis vector lengths <code>a</code>, <code>b</code>, <code>c</code> (associated with <span>$\mathbf{R}_1$</span>, <span>$\mathbf{R}_2$</span>, &amp; <span>$\mathbf{R}_3$</span>, respectively) and specified interaxial angles  <code>α</code> <span>$= ∠(\mathbf{R}_2,\mathbf{R}_3)$</span>, <code>β</code> <span>$= ∠(\mathbf{R}_3,\mathbf{R}_1)$</span>,  <code>γ</code> <span>$= ∠(\mathbf{R}_1,\mathbf{R}_2)$</span>, with <span>$∠$</span> denoting the angle between two vectors.</p><p>For definiteness, the <span>$\mathbf{R}_1$</span> basis vector is oriented along the <span>$x$</span>-axis of the Cartesian coordinate system, and the <span>$\mathbf{R}_2$</span> axis is placed in the <span>$xy$</span>-plane.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/systems.jl#L1-L13">source</a></section><section><div><pre><code class="language-julia hljs">crystal(a, b, γ)  --&gt;  DirectBasis{2}</code></pre><p>Calculate basis vectors <span>$\mathbf{R}_1$</span>, <span>$\mathbf{R}_2$</span> in a 2D Cartesian basis for a  right-handed coordinate system with specified basis vector lengths <code>a</code>, <code>b</code> (associated with <span>$\mathbf{R}_1$</span> &amp; <span>$\mathbf{R}_2$</span>, respectively) and specified interaxial angle <code>γ</code> <span>$= ∠(\mathbf{R}_1,\mathbf{R}_2)$</span>.</p><p>For definiteness, the <span>$\mathbf{R}_1$</span> basis vector is oriented along the <span>$x$</span>-axis of the Cartesian coordinate system.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/systems.jl#L41-L51">source</a></section><section><div><pre><code class="language-julia hljs">crystal(a)  --&gt;  DirectBasis{1}</code></pre><p>Return a one-dimensional crystal with lattice period <code>a</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/systems.jl#L59-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.directbasis" href="#Bravais.directbasis"><code>Bravais.directbasis</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">directbasis(sgnum, D=3;    abclims, αβγlims)
directbasis(sgnum, Val(D); abclims, αβγlims) --&gt; DirectBasis{D}</code></pre><p>Return a random (conventional) <code>DirectBasis</code> for a crystal compatible with the space group number <code>sgnum</code> and dimensionality <code>D</code>. Free parameters in the lattice vectors are chosen randomly, with limits optionally supplied in <code>abclims</code> (lengths) and <code>αβγlims</code> (angles). By convention, the length of the first lattice vector (<code>a</code>) is set to unity, such that the second and third (<code>b</code> and <code>c</code>) lattice vectors&#39; lengths are relative to the first.</p><p>Limits on the relative uniform distribution of lengths <code>b</code> and <code>c</code> can be specified as  2-tuple kwarg <code>abclims</code>; similarly, limits on the angles <code>α</code>, <code>β</code>, <code>γ</code> can be set via αβγlims (only affects oblique, monoclinic, &amp; triclinic lattices).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/systems.jl#L197-L212">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.dualbasis" href="#Bravais.dualbasis"><code>Bravais.dualbasis</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dualbasis(Vs)</code></pre><p>Return the dual (sometimes called the reciprocal) basis of a basis <code>Vs</code> in <code>D</code> dimensions.</p><p>The input basis <code>Vs</code> can be provided as:</p><ul><li>a <code>D</code>-dimensional <code>StaticVector</code> of <code>AbstractVector</code>s,</li><li>a <code>D</code>-dimensional <code>NTuple</code> of <code>AbstractVector</code>s,</li><li>or, type-unstably, as any iterable of <code>AbstractVector</code>s.</li></ul><p>If <code>Vs</code> a <a href="#Bravais.DirectBasis"><code>DirectBasis</code></a>, the type of the returned dual lattice is a <a href="#Bravais.ReciprocalBasis"><code>ReciprocalBasis</code></a> and vice versa. For other input types, no explicit conversion of return type is made.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/transform.jl#L244-L257">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.nigglibasis" href="#Bravais.nigglibasis"><code>Bravais.nigglibasis</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nigglibasis(Rs; rtol=1e-5, max_iterations=200)</code></pre><p>Given a set of primitive basis vectors <code>Rs</code>, return a basis <code>Rs′</code> for the corresponding Niggli-reduced unit cell, as well as a transformation matrix <code>P</code>, such that <code>Rs′ = transform(Rs, P)</code> (see <a href="#Bravais.transform"><code>transform</code></a>).</p><p><strong>Definition</strong></p><p>A Niggli-reduced basis <span>$(\mathbf{a}, \mathbf{b}, \mathbf{c})$</span> represents a unique choice of basis for any given lattice (or, more precisely, a unique choice of the basis vector lengths <span>$|\mathbf{a}|, |\mathbf{b}|, |\mathbf{c}|$</span>, and mutual angles between  <span>$\mathbf{a}, \mathbf{b}, \mathbf{c}$</span>). This uniqueness is one of the main motivations for computing the Niggli reduction procedure, as it enables easy comparison of lattices. Additionally, the associated Niggli-reduced basis vectors <span>$(\mathbf{a}, \mathbf{b}, \mathbf{c})$</span>, fulfil several conditions <sup class="footnote-reference"><a id="citeref-3" href="#footnote-3">[3]</a></sup>:</p><ol><li><strong>&quot;Main&quot; conditions:</strong><ul><li>The basis vectors are sorted by increasing length: <span>$|\mathbf{a}| ≤ |\mathbf{b}| ≤ |\mathbf{c}|$</span>.</li><li>The angles between basis vectors are either all acute or all non-acute.</li></ul></li><li><strong>&quot;Special&quot; conditions:</strong><ul><li>Several special conditions, applied in &quot;special&quot; cases, such as <span>$|\mathbf{a}| = |\mathbf{b}|$</span> or  <code>\mathbf{b}\cdot\mathbf{c} = \tfrac{1}{2}|\mathbf{b}|^2</code>. See Ref. <sup class="footnote-reference"><a id="citeref-3" href="#footnote-3">[3]</a></sup> for details.</li></ul></li></ol><p>Equivalently, the Niggli-reduced basis fulfils the following geometric conditions (Section 9.3.1 of Ref. <sup class="footnote-reference"><a id="citeref-3" href="#footnote-3">[3]</a></sup>):</p><ul><li>The basis vectors are sorted by increasing length.</li><li>The basis vectors have least possible total length, i.e., ``|\mathbf{a}| + |\mathbf{b}|<ul><li>|\mathbf{c}|`` is minimum. I.e., the associated Niggli cell is a Buerger cell.</li></ul></li><li>The associated Buerger cell has maximum deviation among all other Buerger cells, i.e., the basis vector angles <span>$α, β, γ$</span> maximize <span>$|90° - α| + |90° - β| + |90° - γ|$</span>.</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>rtol :: Real</code>: relative tolerance used in the Grosse-Kunstleve approach for floating point comparisons (default: <code>1e-5</code>).</li><li><code>max_iterations :: Int</code>: maximum number of iterations in which to cycle the Krivy-Gruber steps (default: <code>200</code>).</li></ul><p><strong>Implementation</strong></p><p>Implementation follows the algorithm originally described by Krivy &amp; Gruber <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>, with the stability modificiations proposed by Grosse-Kunstleve et al. <sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup> (without which the  algorithm proposed in <sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> simply does not work on floating point hardware).</p><p><sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> I. Krivy &amp; B. Gruber. A unified algorithm for determinign the reduced (Niggli) cell,     <a href="https://doi.org/10.1107/S0567739476000636">Acta Crystallogr. A <strong>32</strong>, 297 (1976)</a>. <sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup> R.W. Grosse-Kunstleve, N.K. Sauter, &amp; P.D. Adams, Numerically stable algorithms for the     computation of reduced unit cells,     <a href="https://doi.org/10.1107/S010876730302186X">Acta Crystallogr. A <strong>60</strong>, 1 (2004)</a> <sup class="footnote-reference"><a id="citeref-3" href="#footnote-3">[3]</a></sup> Sections 9.2 &amp; 9.3, International Tables of Crystallography, Volume A, 5th ed. (2005).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/niggli.jl#L1-L55">source</a></section></article><h3 id="Transformations"><a class="docs-heading-anchor" href="#Transformations">Transformations</a><a id="Transformations-1"></a><a class="docs-heading-anchor-permalink" href="#Transformations" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.primitivebasismatrix" href="#Bravais.primitivebasismatrix"><code>Bravais.primitivebasismatrix</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">primitivebasismatrix(cntr::Char, ::Val{D}=Val(3)) --&gt; SMatrix{D,D,Float64}
primitivebasismatrix(cntr::Char, ::Val{D}, ::Val{P}) --&gt; SMatrix{D,D,Float64}</code></pre><p>Return the transformation matrix <span>$\mathbf{P}$</span> that transforms a conventional unit cell with centering <code>cntr</code> to the corresponding primitive unit cell (in dimension <code>D</code> and periodicity <code>P</code>) in CDML setting.</p><p>If <code>P</code> is not provided, it default to <code>D</code> (as e.g., applicable to Crystalline.jl&#39;s  <code>spacegroup</code>). If <code>D</code> and <code>P</code> differ, a subperiodic group setting is assumed (as e.g., applicable to Crystalline.jl&#39;s <code>subperiodicgroup</code>).</p><p><strong>Transformations in direct and reciprocal space</strong></p><p><strong>Bases</strong></p><p>The returned transformation matrix <span>$\mathbf{P}$</span> transforms a direct-space conventional basis <span>$(\mathbf{a}\ \mathbf{b}\ \mathbf{c})$</span> to the direct-space primitive basis</p><p class="math-container">\[    (\mathbf{a}&#39;\ \mathbf{b}&#39;\ \mathbf{c}&#39;) =
    (\mathbf{a}\ \mathbf{b}\ \mathbf{c})\mathbf{P}.\]</p><p>Analogously, <span>$\mathbf{P}$</span> transforms a reciprocal-space conventional basis <span>$(\mathbf{a}^*\ \mathbf{b}^*\ \mathbf{c}^*)$</span> to </p><p class="math-container">\[(\mathbf{a}^{*\prime}\ \mathbf{b}^{*\prime}\ \mathbf{c}^{*\prime}) =
(\mathbf{a}^*\ \mathbf{b}^*\ \mathbf{c}^*)(\mathbf{P}^{-1})^{\text{T}}.\]</p><p>see also <a href="../api/#Bravais.transform-Tuple{Crystalline.AbstractVec, AbstractMatrix{&lt;:Real}}"><code>transform(::DirectBasis, ::AbstractMatrix{&lt;:Real})</code></a> and <a href="../api/#Bravais.transform-Tuple{Crystalline.AbstractVec, AbstractMatrix{&lt;:Real}}"><code>transform(::ReciprocalBasis, ::AbstractMatrix{&lt;:Real})</code></a>).</p><p><strong>Coordinates</strong></p><p>The coordinates of a point in either direct or reciprocal space, each referred to a basis, also transform under <span>$\mathbf{P}$</span>. Concretely, direct- and reciprocal-space conventional points <span>$\mathbf{r} = (r_1, r_2, r_3)^{\text{T}}$</span> and <span>$\mathbf{k} = (k_1, k_2, k_3)^{\text{T}}$</span>, respectively, transform to a primitive setting under <span>$\mathbf{P}$</span> according to:</p><p class="math-container">\[\mathbf{r}&#39; = \mathbf{P}^{-1}\mathbf{r},\\
\mathbf{k}&#39; = \mathbf{P}^{\text{T}}\mathbf{k}.\]</p><p>See also <a href="../api/#Bravais.transform-Tuple{Crystalline.AbstractVec, AbstractMatrix{&lt;:Real}}"><code>transform(::DirectPoint, ::AbstractMatrix{&lt;:Real})</code></a> and <a href="../api/#Bravais.transform-Tuple{Crystalline.AbstractVec, AbstractMatrix{&lt;:Real}}"><code>transform(::ReciprocalPoint, ::AbstractMatrix{&lt;:Real})</code></a>).</p><p><strong>Setting conventions</strong></p><p>The setting choice for the primitive cell implied by the returned <span>$\mathbf{P}$</span> follows the widely adopted Cracknell-Davies-Miller-Love (CDML) convention.<sup class="footnote-reference"><a id="citeref-CDML" href="#footnote-CDML">[CDML]</a></sup> This convention is explicated e.g. in Table 2 of <sup class="footnote-reference"><a id="citeref-Aroyo" href="#footnote-Aroyo">[Aroyo]</a></sup> (or, alternatively, can be inferred from Tables 1.5.4.1 and 1.5.4.2 of <sup class="footnote-reference"><a id="citeref-ITB2" href="#footnote-ITB2">[ITB2]</a></sup>) and is followed e.g. on the Bilbao Crystallographic Server<sup class="footnote-reference"><a id="citeref-BCS" href="#footnote-BCS">[BCS]</a></sup>, in the CDML reference work on space group irreps<sup class="footnote-reference"><a id="citeref-CDML" href="#footnote-CDML">[CDML]</a></sup>, and in the C library <code>spglib</code>.<sup class="footnote-reference"><a id="citeref-spglib" href="#footnote-spglib">[spglib]</a></sup></p><p>Note that this setting choice is <em>not</em> what is frequently referred to as the &quot;ITA primitive setting&quot;, from which it differs for hP, hR, and oA Bravais types.</p><p>The setting choice is usually referred to as the CDML primitive setting, or, less frequently and more ambiguously, as the crystallographic primitive setting.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/transform.jl#L83-L163">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.transform" href="#Bravais.transform"><code>Bravais.transform</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transform(v::AbstractVec, P::AbstractMatrix)  --&gt;  v′::typeof(v)</code></pre><p>Return a transformed coordinate vector <code>v′</code> from an original coordinate vector <code>v</code> using a basis change matrix <code>P</code>.</p><p>Note that a basis change matrix <span>$\mathbf{P}$</span> transforms direct coordinate vectors (<code>RVec</code>) as <span>$\mathbf{r}&#39; = \mathbf{P}^{-1}\mathbf{r}$</span> but transforms reciprocal coordinates (<code>KVec</code>) as <span>$\mathbf{k}&#39; = \mathbf{P}^{\mathrm{T}}\mathbf{k}$</span> <sup class="footnote-reference"><a id="citeref-ITA6" href="#footnote-ITA6">[ITA6]</a></sup></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/src/types.jl#L432-L444">source</a></section><section><div><pre><code class="language-julia hljs">transform(op::SymOperation, P::AbstractMatrix{&lt;:Real}, 
          p::Union{AbstractVector{&lt;:Real}, Nothing}=nothing,
          modw::Bool=true)                           --&gt; SymOperation</code></pre><p>Transforms a <code>op</code> <span>$= \{\mathbf{W}|\mathbf{w}\}$</span> by a rotation matrix <code>P</code> and a translation vector <code>p</code> (can be <code>nothing</code> for zero-translations), producing a new symmetry operation  <code>op′</code> <span>$= \{\mathbf{W}&#39;|\mathbf{w}&#39;\}$</span> (cf. Section 1.5.2.3 of <sup class="footnote-reference"><a id="citeref-ITA6" href="#footnote-ITA6">[ITA6]</a></sup>)</p><p class="math-container">\[\{\mathbf{W}&#39;|\mathbf{w}&#39;\} = \{\mathbf{P}|\mathbf{p}\}^{-1}\{\mathbf{W}|\mathbf{w}\}
\{\mathbf{P}|\mathbf{p}\}\]</p><p>with</p><p class="math-container">\[\mathbf{W}&#39; = \mathbf{P}^{-1}\mathbf{W}\mathbf{P}
\text{ and }
\mathbf{w}&#39; = \mathbf{P}^{-1}(\mathbf{w}+\mathbf{W}\mathbf{p}-\mathbf{p})\]</p><p>By default, the translation part of <code>op′</code>, i.e. <span>$\mathbf{w}&#39;$</span>, is reduced to the range <span>$[0,1)$</span>, i.e. computed modulo 1. This can be disabled by setting <code>modw = false</code> (default, <code>modw = true</code>).</p><p>See also <a href="#Bravais.primitivize-Tuple{SymOperation, Char, Bool}"><code>Bravais.primitivize(::SymOperation, ::Char, ::Bool)</code></a> and <a href="#Bravais.conventionalize-Tuple{SymOperation, Char, Bool}"><code>Bravais.conventionalize(::SymOperation, ::Char, ::Bool)</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/src/symops.jl#L671-L702">source</a></section><section><div><pre><code class="language-julia hljs">transform(Rs::DirectBasis, P::AbstractMatrix{&lt;:Real})</code></pre><p>Transform a direct basis <code>Rs</code> <span>$= (\mathbf{a}\ \mathbf{b}\ \mathbf{c})$</span> under the transformation matrix <code>P</code> <span>$= \mathbf{P}$</span>, returning  <code>Rs′</code> <span>$= (\mathbf{a}&#39;\ \mathbf{b}&#39;\ \mathbf{c}&#39;) = (\mathbf{a}\ \mathbf{b}\ \mathbf{c}) \mathbf{P}$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/transform.jl#L294-L301">source</a></section><section><div><pre><code class="language-julia hljs">transform(Gs::ReciprocalBasis, P::AbstractMatrix{&lt;:Real})</code></pre><p>Transform a reciprocal basis <code>Gs</code> <span>$= (\mathbf{a}^* \mathbf{b}^* \mathbf{c}^*)$</span> under the transformation matrix <code>P</code> <span>$= \mathbf{P}$</span>, returning  <code>Gs′</code> <span>$= (\mathbf{a}^{*\prime}\ \mathbf{b}^{*\prime}\ \mathbf{c}^{*\prime}) = (\mathbf{a}^*\ \mathbf{b}^*\ \mathbf{c}^*)(\mathbf{P}^{-1})^{\text{T}}$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/transform.jl#L308-L315">source</a></section><section><div><pre><code class="language-julia hljs">transform(r::DirectPoint, P::AbstractMatrix{&lt;:Real})  --&gt;  r′::typeof(r)</code></pre><p>Transform a point in direct space <code>r</code> <span>$= (r_1, r_2, r_3)^{\text{T}}$</span> under the transformation matrix <code>P</code> <span>$= \mathbf{P}$</span>, returning <code>r′</code> <span>$= (r_1′, r_2′, r_3′)^{\text{T}} = \mathbf{P}^{-1}(r_1, r_2, r_3)^{\text{T}}$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/transform.jl#L322-L328">source</a></section><section><div><pre><code class="language-julia hljs">transform(k::ReciprocalPoint, P::AbstractMatrix{&lt;:Real})  --&gt;  k′::typeof(k)</code></pre><p>Transform a point in reciprocal space <code>k</code> <span>$= (k_1, k_2, k_3)^{\text{T}}$</span> under the transformation matrix <code>P</code> <span>$= \mathbf{P}$</span>, returning <code>k′</code> <span>$= (k_1′, k_2′, k_3′)^{\text{T}} = \mathbf{P}^{\text{T}}(k_1, k_2, k_3)^{\text{T}}$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/transform.jl#L333-L339">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.primitivize" href="#Bravais.primitivize"><code>Bravais.primitivize</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">primitivize(v::AbstractVec, cntr::Char)  --&gt;  v′::typeof(v)</code></pre><p>Transforms a conventional coordinate vector <code>v</code> to a standard primitive basis (specified by the centering type <code>cntr</code>), returning the primitive coordinate vector <code>v′</code>.</p><p>Note that a basis change matrix <span>$\mathbf{P}$</span> (as returned e.g. by <a href="#Bravais.primitivebasismatrix"><code>Bravais.primitivebasismatrix</code></a>) transforms direct coordinate vectors (<a href="../api/#Crystalline.RVec-Union{Tuple{AbstractString}, Tuple{D}} where D"><code>RVec</code></a>) as <span>$\mathbf{r}&#39; = \mathbf{P}^{-1}\mathbf{r}$</span> but transforms reciprocal coordinates (<a href="../api/#Crystalline.KVec-Union{Tuple{AbstractString}, Tuple{D}} where D"><code>KVec</code></a>) as <span>$\mathbf{k}&#39; = \mathbf{P}^{\text{T}}\mathbf{k}$</span> <sup class="footnote-reference"><a id="citeref-ITA6" href="#footnote-ITA6">[ITA6]</a></sup>. Recall also the distinction between transforming a basis and the coordinates of a vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/src/types.jl#L460-L474">source</a></section><section><div><pre><code class="language-julia hljs">primitivize(op::SymOperation, cntr::Char, modw::Bool=true) --&gt; typeof(op)</code></pre><p>Return a symmetry operation <code>op′</code> <span>$≡ \{W&#39;|w&#39;\}$</span> in a primitive setting, transformed from an input symmetry operation <code>op</code> <span>$= \{W|w\}$</span> in a conventional setting. The operations <span>$\{W&#39;|w&#39;\}$</span> and <span>$\{W|w\}$</span> are related by a transformation <span>$\{P|p\}$</span> via (cf. Section 1.5.2.3 of <sup class="footnote-reference"><a id="citeref-ITA6" href="#footnote-ITA6">[ITA6]</a></sup>):</p><p class="math-container">\[\{W&#39;|w&#39;\} = \{P|p\}⁻¹\{W|w\}\{P|p\}.\]</p><p>where <span>$P$</span> and <span>$p$</span> are the basis change matrix and origin shifts, respectively. The relevant transformation <span>$\{P|p\}$</span> is inferred from the centering type, as provided by <code>cntr</code> (see also <a href="#Bravais.centering"><code>Bravais.centering</code></a>).</p><p>By default, translation parts of <code>op′</code>, i.e. <span>$w&#39;$</span> are reduced modulo 1 (<code>modw = true</code>); to disable this, set <code>modw = false</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/src/symops.jl#L621-L641">source</a></section><section><div><pre><code class="language-julia hljs">primitivize(flat::AbstractFourierLattice, cntr::Char) --&gt; ::typeof(flat)</code></pre><p>Given <code>flat</code> referred to a conventional basis with centering <code>cntr</code>, compute the derived (but physically equivalent) lattice <code>flat′</code> referred to the associated primitive basis. </p><p>Specifically, if <code>flat</code> refers to a direct conventional basis <code>Rs</code> <span>$≡ (\mathbf{a} \mathbf{b} \mathbf{c})$</span> [with coordinate vectors <span>$\mathbf{r} ≡ (r_1, r_2, r_3)^{\mathrm{T}}$</span>] then <code>flat′</code> refers to a direct primitive basis <code>Rs′</code> <span>$≡ (\mathbf{a}&#39; \mathbf{b}&#39; \mathbf{c}&#39;) ≡ (\mathbf{a} \mathbf{b} \mathbf{c})\mathbf{P}$</span> [with coordinate vectors  <span>$\mathbf{r}&#39; ≡ (r_1&#39;, r_2&#39;, r_3&#39;)^{\mathrm{T}} = \mathbf{P}^{-1}\mathbf{r}$</span>], where <span>$\mathbf{P}$</span> denotes the basis-change matrix obtained from <code>primitivebasismatrix(...)</code>.</p><p>To compute the associated primitive basis vectors, see <a href="../api/#Bravais.primitivize-Union{Tuple{D}, Tuple{Crystalline.AbstractFourierLattice{D}, Char}} where D"><code>primitivize(::DirectBasis, ::Char)</code></a> [specifically, <code>Rs′ = primitivize(Rs, cntr)</code>].</p><p><strong>Examples</strong></p><p>A centered (&#39;c&#39;) lattice from plane group 5 in 2D, plotted in its  conventional and primitive basis (requires <code>using PyPlot</code>):</p><pre><code class="language-julia-repl hljs">julia&gt; sgnum = 5; D = 2; cntr = centering(sgnum, D)  # &#39;c&#39; (body-centered)

julia&gt; Rs   = directbasis(sgnum, Val(D))     # conventional basis (rectangular)
julia&gt; flat = levelsetlattice(sgnum, Val(D)) # Fourier lattice in basis of Rs
julia&gt; flat = modulate(flat)                 # modulate the lattice coefficients
julia&gt; plot(flat, Rs)

julia&gt; Rs′   = primitivize(Rs, cntr)    # primitive basis (oblique)
julia&gt; flat′ = primitivize(flat, cntr)  # Fourier lattice in basis of Rs′

julia&gt; using PyPlot
julia&gt; plot(flat′, Rs′)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/src/lattices.jl#L253-L290">source</a></section><section><div><pre><code class="language-julia hljs">primitivize(V::Union{AbstractBasis, AbstractPoint}, 
            cntr_or_sgnum::Union{Char, &lt;:Integer})   --&gt;  V′::typeof(V)</code></pre><p>Return the primitive basis or point <code>V′</code> associated with the input conventional <code>AbstractBasis</code> or <code>AbstractPoint</code> <code>V</code>.</p><p>The assumed centering type is specified by <code>cntr_or_sgnum</code>, given either as a centering character (<code>::Char</code>) or inferred from a space group number (<code>::Integer</code>) and the dimensionality of <code>V</code> (see also <a href="../api/#Bravais.centering-Union{Tuple{Union{LittleGroup{D}, SpaceGroup{D}}}, Tuple{D}} where D"><code>centering(::Integer, ::Integer)</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/transform.jl#L360-L371">source</a></section><section><div><pre><code class="language-julia hljs">primitivize(Rs::DirectBasis, cntr_or_sgnum::Union{Char, &lt;:Integer}) --&gt; Rs′::typeof(Rs)</code></pre><p>Return the primitive direct basis <code>Rs′</code> corresponding to the input conventional direct basis <code>Rs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/transform.jl#L373-L378">source</a></section><section><div><pre><code class="language-julia hljs">primitivize(Gs::ReciprocalBasis, cntr_or_sgnum::Union{Char, &lt;:Integer}) --&gt; Gs′::typeof(Gs)</code></pre><p>Return the primitive reciprocal basis <code>Gs′</code> corresponding to the input conventional reciprocal basis <code>Gs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/transform.jl#L381-L386">source</a></section><section><div><pre><code class="language-julia hljs">primitivize(r::DirectPoint, cntr_or_sgnum::Union{Char, &lt;:Integer}) --&gt; r′::typeof(r)</code></pre><p>Return the direct point <code>r′</code> with coordinates in a primitive basis, corresponding to the input point <code>r</code> with coordinates in a conventional basis. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/transform.jl#L389-L394">source</a></section><section><div><pre><code class="language-julia hljs">primitivize(k::ReciprocalPoint, cntr_or_sgnum::Union{Char, &lt;:Integer}) --&gt; k′::typeof(k)</code></pre><p>Return the reciprocal point <code>k′</code> with coordinates in a primitive basis, corresponding to the input point <code>k</code> with coordinates in a conventional basis. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/transform.jl#L397-L402">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.conventionalize" href="#Bravais.conventionalize"><code>Bravais.conventionalize</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">conventionalize(v′::AbstractVec, cntr::Char)  --&gt;  v::typeof(v′)</code></pre><p>Transforms a primitive coordinate vector <code>v′</code> back to a standard conventional basis (specified by the centering type <code>cntr</code>), returning the conventional coordinate vector <code>v</code>.</p><p>See also <a href="#Bravais.primitivize"><code>primitivize</code></a> and <a href="#Bravais.transform"><code>transform</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/src/types.jl#L484-L491">source</a></section><section><div><pre><code class="language-julia hljs">conventionalize(op′::SymOperation, cntr::Char, modw::Bool=true) --&gt; typeof(op)</code></pre><p>Return a symmetry operation <code>op</code> <span>$= \{W|w\}$</span> in a conventional setting, transformed from an input symmetry operation <code>op′</code> <span>$≡ \{W&#39;|w&#39;\}$</span> in a primitive setting.</p><p>See <a href="#Bravais.primitivize-Tuple{SymOperation, Char, Bool}"><code>primitivize(::SymOperation, ::Char, ::Bool)</code></a> for description of the centering argument <code>cntr</code> and optional argument <code>modw</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/src/symops.jl#L652-L660">source</a></section><section><div><pre><code class="language-julia hljs">conventionalize(flat::AbstractFourierLattice, cntr::Char) --&gt; ::typeof(flat′)</code></pre><p>Given <code>flat</code> referred to a primitive basis with centering <code>cntr</code>, compute the derived (but physically equivalent) lattice <code>flat′</code> referred to the associated conventional basis. </p><p>See also the complementary method <a href="#Bravais.primitivize-Tuple{Crystalline.AbstractFourierLattice, Char}"><code>primitivize(::AbstractFourierLattice, ::Char)</code></a> for additional details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/src/lattices.jl#L301-L309">source</a></section><section><div><pre><code class="language-julia hljs">conventionalize(V′::Union{AbstractBasis, AbstractPoint}, 
                cntr_or_sgnum::Union{Char, &lt;:Integer})    --&gt;  V::typeof(V′)</code></pre><p>Return the conventional basis or point <code>V</code> associated with the input primitive <code>AbstractBasis</code> or <code>AbstractPoint</code> <code>V′</code>.</p><p>The assumed centering type is specified by <code>cntr_or_sgnum</code>, given either as a centering character (<code>::Char</code>) or inferred from a space group number (<code>::Integer</code>) and the dimensionality of <code>V′</code> (see also <a href="../api/#Bravais.centering-Union{Tuple{Union{LittleGroup{D}, SpaceGroup{D}}}, Tuple{D}} where D"><code>centering(::Integer, ::Integer)</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/transform.jl#L421-L432">source</a></section><section><div><pre><code class="language-julia hljs">conventionalize(Rs′::DirectBasis, cntr_or_sgnum::Union{Char, &lt;:Integer}) --&gt; Rs::typeof(Rs′)</code></pre><p>Return the conventional direct basis <code>Rs</code> corresponding to the input primitive direct basis <code>Rs′</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/transform.jl#L434-L439">source</a></section><section><div><pre><code class="language-julia hljs">conventionalize(Gs′::ReciprocalBasis, cntr_or_sgnum::Union{Char, &lt;:Integer}) --&gt; Gs::typeof(Gs′)</code></pre><p>Return the conventional reciprocal basis <code>Gs</code> corresponding to the input primitive reciprocal basis <code>Gs′</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/transform.jl#L442-L447">source</a></section><section><div><pre><code class="language-julia hljs">conventionalize(r′::DirectPoint, cntr_or_sgnum::Union{Char, &lt;:Integer}) --&gt; r::typeof(r′)</code></pre><p>Return the direct point <code>r</code> with coordinates in a conventional basis, corresponding to the input point <code>r′</code> with coordinates in a primitive basis.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/transform.jl#L450-L455">source</a></section><section><div><pre><code class="language-julia hljs">conventionalize(k′::ReciprocalPoint, cntr_or_sgnum::Union{Char, &lt;:Integer}) --&gt; k::typeof(k′)</code></pre><p>Return the reciprocal point <code>k</code> with coordinates in a conventional basis, corresponding to the input point <code>k′</code> with coordinates in a primitive basis. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/transform.jl#L458-L463">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.cartesianize" href="#Bravais.cartesianize"><code>Bravais.cartesianize</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cartesianize</code></pre><p>Transform an object with coordinates in an lattice basis to an object with coordinates in a Cartesian basis.</p><p>Depending on the object, the basis may be inferrable directly from the object; if not, it must be supplied explicitly. @doc </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/transform.jl#L481-L488">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.cartesianize!" href="#Bravais.cartesianize!"><code>Bravais.cartesianize!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cartesianize!</code></pre><p>In-place transform an object with coordinates in an lattice basis to an object with coordinates in a Cartesian basis.</p><p>Depending on the object, the basis may be inferrable directly from the object; if not, it must be supplied explicitly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/transform.jl#L471-L478">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.latticize" href="#Bravais.latticize"><code>Bravais.latticize</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">latticize</code></pre><p>Transform an object with coordinates in a Cartesian basis to an object with coordinates in a lattice basis.</p><p>Depending on the object, the basis may be inferrable directly from the object; if not, it must be supplied explicitly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/transform.jl#L501-L508">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.latticize!" href="#Bravais.latticize!"><code>Bravais.latticize!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">latticize!</code></pre><p>In-place transform object with coordinates in a Cartesian basis to an object with coordinates in a lattice basis.</p><p>Depending on the object, the basis may be inferrable directly from the object; if not, it must be supplied explicitly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/transform.jl#L491-L498">source</a></section></article><h3 id="Miscellaneous"><a class="docs-heading-anchor" href="#Miscellaneous">Miscellaneous</a><a id="Miscellaneous-1"></a><a class="docs-heading-anchor-permalink" href="#Miscellaneous" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.volume" href="#Bravais.volume"><code>Bravais.volume</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">volume(Vs::AbstractBasis)</code></pre><p>Return the volume <span>$V$</span> of the unit cell associated with the basis <code>Vs::AbstractBasis{D}</code>.</p><p>The volume is computed as <span>$V = \sqrt{\mathrm{det}\mathbf{G}}$</span> with with <span>$\mathbf{G}$</span> denoting the metric matrix of <code>Vs</code> (cf. the International Tables of Crystallography,  Volume A, Section 5.2.2.3).</p><p>See also <a href="#Bravais.metricmatrix"><code>metricmatrix</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/types.jl#L84-L94">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.metricmatrix" href="#Bravais.metricmatrix"><code>Bravais.metricmatrix</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">metricmatrix(Vs::AbstractBasis)</code></pre><p>Return the (real, symmetric) metric matrix of a basis <code>Vs</code>, i.e., the matrix with elements <span>$G_{ij} =$</span> <code>dot(Vs[i], Vs[j])</code>, as defined in the International Tables of Crystallography, Volume A, Section 5.2.2.3.</p><p>Equivalently, this is the Gram matrix of <code>Vs</code>, and so can also be expressed as <code>Vm&#39; * Vm</code> with <code>Vm</code> denoting the columnwise concatenation of the basis vectors in <code>Vs</code>.</p><p>See also <a href="#Bravais.volume"><code>volume</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/Bravais/src/types.jl#L97-L108">source</a></section></article><h2 id="Crystalline.jl-extensions-of-Bravais.jl-functions"><a class="docs-heading-anchor" href="#Crystalline.jl-extensions-of-Bravais.jl-functions">Crystalline.jl extensions of Bravais.jl functions</a><a id="Crystalline.jl-extensions-of-Bravais.jl-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Crystalline.jl-extensions-of-Bravais.jl-functions" title="Permalink"></a></h2><h3 id="SymOperation"><a class="docs-heading-anchor" href="#SymOperation"><code>SymOperation</code></a><a id="SymOperation-1"></a><a class="docs-heading-anchor-permalink" href="#SymOperation" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.transform" href="#Bravais.transform"><code>Bravais.transform</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transform(op::SymOperation, P::AbstractMatrix{&lt;:Real}, 
          p::Union{AbstractVector{&lt;:Real}, Nothing}=nothing,
          modw::Bool=true)                           --&gt; SymOperation</code></pre><p>Transforms a <code>op</code> <span>$= \{\mathbf{W}|\mathbf{w}\}$</span> by a rotation matrix <code>P</code> and a translation vector <code>p</code> (can be <code>nothing</code> for zero-translations), producing a new symmetry operation  <code>op′</code> <span>$= \{\mathbf{W}&#39;|\mathbf{w}&#39;\}$</span> (cf. Section 1.5.2.3 of <sup class="footnote-reference"><a id="citeref-ITA6" href="#footnote-ITA6">[ITA6]</a></sup>)</p><p class="math-container">\[\{\mathbf{W}&#39;|\mathbf{w}&#39;\} = \{\mathbf{P}|\mathbf{p}\}^{-1}\{\mathbf{W}|\mathbf{w}\}
\{\mathbf{P}|\mathbf{p}\}\]</p><p>with</p><p class="math-container">\[\mathbf{W}&#39; = \mathbf{P}^{-1}\mathbf{W}\mathbf{P}
\text{ and }
\mathbf{w}&#39; = \mathbf{P}^{-1}(\mathbf{w}+\mathbf{W}\mathbf{p}-\mathbf{p})\]</p><p>By default, the translation part of <code>op′</code>, i.e. <span>$\mathbf{w}&#39;$</span>, is reduced to the range <span>$[0,1)$</span>, i.e. computed modulo 1. This can be disabled by setting <code>modw = false</code> (default, <code>modw = true</code>).</p><p>See also <a href="#Bravais.primitivize-Tuple{SymOperation, Char, Bool}"><code>Bravais.primitivize(::SymOperation, ::Char, ::Bool)</code></a> and <a href="#Bravais.conventionalize-Tuple{SymOperation, Char, Bool}"><code>Bravais.conventionalize(::SymOperation, ::Char, ::Bool)</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/src/symops.jl#L671-L702">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.primitivize-Tuple{SymOperation, Char, Bool}" href="#Bravais.primitivize-Tuple{SymOperation, Char, Bool}"><code>Bravais.primitivize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">primitivize(op::SymOperation, cntr::Char, modw::Bool=true) --&gt; typeof(op)</code></pre><p>Return a symmetry operation <code>op′</code> <span>$≡ \{W&#39;|w&#39;\}$</span> in a primitive setting, transformed from an input symmetry operation <code>op</code> <span>$= \{W|w\}$</span> in a conventional setting. The operations <span>$\{W&#39;|w&#39;\}$</span> and <span>$\{W|w\}$</span> are related by a transformation <span>$\{P|p\}$</span> via (cf. Section 1.5.2.3 of <sup class="footnote-reference"><a id="citeref-ITA6" href="#footnote-ITA6">[ITA6]</a></sup>):</p><p class="math-container">\[\{W&#39;|w&#39;\} = \{P|p\}⁻¹\{W|w\}\{P|p\}.\]</p><p>where <span>$P$</span> and <span>$p$</span> are the basis change matrix and origin shifts, respectively. The relevant transformation <span>$\{P|p\}$</span> is inferred from the centering type, as provided by <code>cntr</code> (see also <a href="#Bravais.centering"><code>Bravais.centering</code></a>).</p><p>By default, translation parts of <code>op′</code>, i.e. <span>$w&#39;$</span> are reduced modulo 1 (<code>modw = true</code>); to disable this, set <code>modw = false</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/src/symops.jl#L621-L641">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.conventionalize-Tuple{SymOperation, Char, Bool}" href="#Bravais.conventionalize-Tuple{SymOperation, Char, Bool}"><code>Bravais.conventionalize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">conventionalize(op′::SymOperation, cntr::Char, modw::Bool=true) --&gt; typeof(op)</code></pre><p>Return a symmetry operation <code>op</code> <span>$= \{W|w\}$</span> in a conventional setting, transformed from an input symmetry operation <code>op′</code> <span>$≡ \{W&#39;|w&#39;\}$</span> in a primitive setting.</p><p>See <a href="#Bravais.primitivize-Tuple{SymOperation, Char, Bool}"><code>primitivize(::SymOperation, ::Char, ::Bool)</code></a> for description of the centering argument <code>cntr</code> and optional argument <code>modw</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/src/symops.jl#L652-L660">source</a></section></article><h3 id="AbstractVec"><a class="docs-heading-anchor" href="#AbstractVec"><code>AbstractVec</code></a><a id="AbstractVec-1"></a><a class="docs-heading-anchor-permalink" href="#AbstractVec" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.transform-Tuple{Crystalline.AbstractVec, AbstractMatrix{&lt;:Real}}" href="#Bravais.transform-Tuple{Crystalline.AbstractVec, AbstractMatrix{&lt;:Real}}"><code>Bravais.transform</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transform(v::AbstractVec, P::AbstractMatrix)  --&gt;  v′::typeof(v)</code></pre><p>Return a transformed coordinate vector <code>v′</code> from an original coordinate vector <code>v</code> using a basis change matrix <code>P</code>.</p><p>Note that a basis change matrix <span>$\mathbf{P}$</span> transforms direct coordinate vectors (<code>RVec</code>) as <span>$\mathbf{r}&#39; = \mathbf{P}^{-1}\mathbf{r}$</span> but transforms reciprocal coordinates (<code>KVec</code>) as <span>$\mathbf{k}&#39; = \mathbf{P}^{\mathrm{T}}\mathbf{k}$</span> <sup class="footnote-reference"><a id="citeref-ITA6" href="#footnote-ITA6">[ITA6]</a></sup></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/src/types.jl#L432-L444">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.primitivize-Tuple{Crystalline.AbstractVec, Char}" href="#Bravais.primitivize-Tuple{Crystalline.AbstractVec, Char}"><code>Bravais.primitivize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">primitivize(v::AbstractVec, cntr::Char)  --&gt;  v′::typeof(v)</code></pre><p>Transforms a conventional coordinate vector <code>v</code> to a standard primitive basis (specified by the centering type <code>cntr</code>), returning the primitive coordinate vector <code>v′</code>.</p><p>Note that a basis change matrix <span>$\mathbf{P}$</span> (as returned e.g. by <a href="#Bravais.primitivebasismatrix"><code>Bravais.primitivebasismatrix</code></a>) transforms direct coordinate vectors (<a href="../api/#Crystalline.RVec-Union{Tuple{AbstractString}, Tuple{D}} where D"><code>RVec</code></a>) as <span>$\mathbf{r}&#39; = \mathbf{P}^{-1}\mathbf{r}$</span> but transforms reciprocal coordinates (<a href="../api/#Crystalline.KVec-Union{Tuple{AbstractString}, Tuple{D}} where D"><code>KVec</code></a>) as <span>$\mathbf{k}&#39; = \mathbf{P}^{\text{T}}\mathbf{k}$</span> <sup class="footnote-reference"><a id="citeref-ITA6" href="#footnote-ITA6">[ITA6]</a></sup>. Recall also the distinction between transforming a basis and the coordinates of a vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/src/types.jl#L460-L474">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.conventionalize-Tuple{Crystalline.AbstractVec, Char}" href="#Bravais.conventionalize-Tuple{Crystalline.AbstractVec, Char}"><code>Bravais.conventionalize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">conventionalize(v′::AbstractVec, cntr::Char)  --&gt;  v::typeof(v′)</code></pre><p>Transforms a primitive coordinate vector <code>v′</code> back to a standard conventional basis (specified by the centering type <code>cntr</code>), returning the conventional coordinate vector <code>v</code>.</p><p>See also <a href="#Bravais.primitivize"><code>primitivize</code></a> and <a href="#Bravais.transform"><code>transform</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/src/types.jl#L484-L491">source</a></section></article><h3 id="AbstractFourierLattice"><a class="docs-heading-anchor" href="#AbstractFourierLattice"><code>AbstractFourierLattice</code></a><a id="AbstractFourierLattice-1"></a><a class="docs-heading-anchor-permalink" href="#AbstractFourierLattice" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.primitivize-Tuple{Crystalline.AbstractFourierLattice, Char}" href="#Bravais.primitivize-Tuple{Crystalline.AbstractFourierLattice, Char}"><code>Bravais.primitivize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">primitivize(flat::AbstractFourierLattice, cntr::Char) --&gt; ::typeof(flat)</code></pre><p>Given <code>flat</code> referred to a conventional basis with centering <code>cntr</code>, compute the derived (but physically equivalent) lattice <code>flat′</code> referred to the associated primitive basis. </p><p>Specifically, if <code>flat</code> refers to a direct conventional basis <code>Rs</code> <span>$≡ (\mathbf{a} \mathbf{b} \mathbf{c})$</span> [with coordinate vectors <span>$\mathbf{r} ≡ (r_1, r_2, r_3)^{\mathrm{T}}$</span>] then <code>flat′</code> refers to a direct primitive basis <code>Rs′</code> <span>$≡ (\mathbf{a}&#39; \mathbf{b}&#39; \mathbf{c}&#39;) ≡ (\mathbf{a} \mathbf{b} \mathbf{c})\mathbf{P}$</span> [with coordinate vectors  <span>$\mathbf{r}&#39; ≡ (r_1&#39;, r_2&#39;, r_3&#39;)^{\mathrm{T}} = \mathbf{P}^{-1}\mathbf{r}$</span>], where <span>$\mathbf{P}$</span> denotes the basis-change matrix obtained from <code>primitivebasismatrix(...)</code>.</p><p>To compute the associated primitive basis vectors, see <a href="../api/#Bravais.primitivize-Union{Tuple{D}, Tuple{Crystalline.AbstractFourierLattice{D}, Char}} where D"><code>primitivize(::DirectBasis, ::Char)</code></a> [specifically, <code>Rs′ = primitivize(Rs, cntr)</code>].</p><p><strong>Examples</strong></p><p>A centered (&#39;c&#39;) lattice from plane group 5 in 2D, plotted in its  conventional and primitive basis (requires <code>using PyPlot</code>):</p><pre><code class="language-julia-repl hljs">julia&gt; sgnum = 5; D = 2; cntr = centering(sgnum, D)  # &#39;c&#39; (body-centered)

julia&gt; Rs   = directbasis(sgnum, Val(D))     # conventional basis (rectangular)
julia&gt; flat = levelsetlattice(sgnum, Val(D)) # Fourier lattice in basis of Rs
julia&gt; flat = modulate(flat)                 # modulate the lattice coefficients
julia&gt; plot(flat, Rs)

julia&gt; Rs′   = primitivize(Rs, cntr)    # primitive basis (oblique)
julia&gt; flat′ = primitivize(flat, cntr)  # Fourier lattice in basis of Rs′

julia&gt; using PyPlot
julia&gt; plot(flat′, Rs′)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/src/lattices.jl#L253-L290">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Bravais.conventionalize-Tuple{Crystalline.AbstractFourierLattice, Char}" href="#Bravais.conventionalize-Tuple{Crystalline.AbstractFourierLattice, Char}"><code>Bravais.conventionalize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">conventionalize(flat::AbstractFourierLattice, cntr::Char) --&gt; ::typeof(flat′)</code></pre><p>Given <code>flat</code> referred to a primitive basis with centering <code>cntr</code>, compute the derived (but physically equivalent) lattice <code>flat′</code> referred to the associated conventional basis. </p><p>See also the complementary method <a href="#Bravais.primitivize-Tuple{Crystalline.AbstractFourierLattice, Char}"><code>primitivize(::AbstractFourierLattice, ::Char)</code></a> for additional details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/ad644c1bc7fd735597a5e8c1d6f32dc1552d7aa6/src/lattices.jl#L301-L309">source</a></section></article><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-ITA6"><a class="tag is-link" href="#citeref-ITA6">ITA6</a>M.I. Aroyo, International Tables of Crystallography, Vol. A, 6th ed. (2016): Tables      3.1.2.1 and 3.1.2.2 (or Tables 2.1.2.1, 9.1.7.1, and 9.1.7.2 of <sup class="footnote-reference"><a id="citeref-ITA5" href="#footnote-ITA5">[ITA5]</a></sup>).</li><li class="footnote" id="footnote-ITA5"><a class="tag is-link" href="#citeref-ITA5">ITA5</a>T. Hahn, International Tables of Crystallography, Vol. A, 5th ed. (2005).</li><li class="footnote" id="footnote-CDML"><a class="tag is-link" href="#citeref-CDML">CDML</a>Cracknell, Davies, Miller, &amp; Love, Kroenecker Product Tables, Vol. 1 (1979).</li><li class="footnote" id="footnote-BCS"><a class="tag is-link" href="#citeref-BCS">BCS</a>Bilbao Crystallographic Server, <a href="https://www.cryst.ehu.es/cryst/get_kvec.html">KVEC</a>.</li><li class="footnote" id="footnote-Aroyo"><a class="tag is-link" href="#citeref-Aroyo">Aroyo</a>Aroyo <em>et al.</em>, <a href="https://doi.org/10.1107/S205327331303091X">Acta Cryst. A70, 126 (2014)</a>: Table 2 gives       <span>$(\mathbf{P}^{-1})^{\text{T}}$</span>.</li><li class="footnote" id="footnote-ITB2"><a class="tag is-link" href="#citeref-ITB2">ITB2</a>Hahn, International Tables of Crystallography, Vol. B, 2nd edition (2001).</li><li class="footnote" id="footnote-spglib"><a class="tag is-link" href="#citeref-spglib">spglib</a>Spglib documentation: <a href="https://spglib.github.io/spglib/definition.html#transformation-to-the-primitive-cell">Transformation to the primitive setting</a>.        Thus, Bravais.jl and <a href="https://github.com/singularitti/Spglib.jl">Spglib.jl</a>        transform to identical primitive settings and are hence mutually compatible.</li><li class="footnote" id="footnote-ITA6"><a class="tag is-link" href="#citeref-ITA6">ITA6</a>M.I. Aroyo, International Tables of Crystallography, Vol. A, 6th edition (2016):      Secs. 1.5.1.2 and 1.5.2.1.</li><li class="footnote" id="footnote-ITA6"><a class="tag is-link" href="#citeref-ITA6">ITA6</a>M.I. Aroyo, International Tables of Crystallography, Vol. A, 6th ed. (2016).</li><li class="footnote" id="footnote-ITA6"><a class="tag is-link" href="#citeref-ITA6">ITA6</a>M.I. Aroyo, International Tables of Crystallography, Vol. A, 6th edition (2016):      Secs. 1.5.1.2 and 1.5.2.1.</li><li class="footnote" id="footnote-ITA6"><a class="tag is-link" href="#citeref-ITA6">ITA6</a>M.I. Aroyo, International Tables of Crystallography, Vol. A, 6th ed. (2016).</li><li class="footnote" id="footnote-ITA6"><a class="tag is-link" href="#citeref-ITA6">ITA6</a>M.I. Aroyo, International Tables of Crystallography, Vol. A, 6th ed. (2016).</li><li class="footnote" id="footnote-ITA6"><a class="tag is-link" href="#citeref-ITA6">ITA6</a>M.I. Aroyo, International Tables of Crystallography, Vol. A, 6th ed. (2016).</li><li class="footnote" id="footnote-ITA6"><a class="tag is-link" href="#citeref-ITA6">ITA6</a>M.I. Aroyo, International Tables of Crystallography, Vol. A, 6th edition (2016):      Secs. 1.5.1.2 and 1.5.2.1.</li><li class="footnote" id="footnote-ITA6"><a class="tag is-link" href="#citeref-ITA6">ITA6</a>M.I. Aroyo, International Tables of Crystallography, Vol. A, 6th edition (2016):      Secs. 1.5.1.2 and 1.5.2.1.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../irreps/">« Irreps</a><a class="docs-footer-nextpage" href="../bandreps/">Band representations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Tuesday 1 April 2025 20:06">Tuesday 1 April 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
