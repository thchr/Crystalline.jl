<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Band representations · Crystalline.jl</title><meta name="title" content="Band representations · Crystalline.jl"/><meta property="og:title" content="Band representations · Crystalline.jl"/><meta property="twitter:title" content="Band representations · Crystalline.jl"/><meta name="description" content="Documentation for Crystalline.jl."/><meta property="og:description" content="Documentation for Crystalline.jl."/><meta property="twitter:description" content="Documentation for Crystalline.jl."/><meta property="og:url" content="https://thchr.github.io/Crystalline.jl/bandreps/"/><meta property="twitter:url" content="https://thchr.github.io/Crystalline.jl/bandreps/"/><link rel="canonical" href="https://thchr.github.io/Crystalline.jl/bandreps/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img class="docs-light-only" src="../assets/logo.svg" alt="Crystalline.jl logo"/><img class="docs-dark-only" src="../assets/logo-dark.svg" alt="Crystalline.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Crystalline.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../operations/">Symmetry operations</a></li><li><a class="tocitem" href="../groups/">Groups</a></li><li><a class="tocitem" href="../irreps/">Irreps</a></li><li><a class="tocitem" href="../bravais/">Bravais types &amp; bases</a></li><li class="is-active"><a class="tocitem" href>Band representations</a><ul class="internal"><li><a class="tocitem" href="#Topological-analysis"><span>Topological analysis</span></a></li><li><a class="tocitem" href="#Associated-bases"><span>Associated bases</span></a></li><li><a class="tocitem" href="#API"><span>API</span></a></li></ul></li><li><a class="tocitem" href="../lattices/">Lattices</a></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../internal-api/">Internal API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Band representations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Band representations</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/thchr/Crystalline.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/thchr/Crystalline.jl/blob/master/docs/src/bandreps.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Elementary-band-representations"><a class="docs-heading-anchor" href="#Elementary-band-representations">Elementary band representations</a><a id="Elementary-band-representations-1"></a><a class="docs-heading-anchor-permalink" href="#Elementary-band-representations" title="Permalink"></a></h1><p>Crystalline.jl provides an interface to access the elementary band representations (EBRs) hosted by the Bilbao Crystallographic Server&#39;s <a href="https://www.cryst.ehu.es/cgi-bin/cryst/programs/bandrep.pl">BANDREP</a> program via <a href="../api/#Crystalline.bandreps"><code>bandreps</code></a>. Crystalline also provides <a href="../api/#Crystalline.calc_bandreps-Union{Tuple{Integer}, Tuple{D}, Tuple{Integer, Val{D}}} where D"><code>calc_bandreps</code></a>, which computes the band representations across all maximal<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> Wyckoff positions directly. Usually, <code>calc_bandreps</code> is preferable, as it returns more contextual information and aligns more simply with the existing conventions of Crystalline, from which it derives.</p><p>As an example, we can obtain the all inequivalent EBRs in space group 219 (F-43c) with:</p><pre><code class="language-julia hljs">using Crystalline

brs = calc_bandreps(219, Val(3)) # space group 219 (dimension 3)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">12-element Collection{NewBandRep{3}} for ⋕219 (F-43c) over 14 irreps (spin-1 w/TR):
──────┬──────────────────────────────────────────────────────
<span class="sgr1">      │ 24d  24d  24d  24c  24c  24c  8b  8b  8b  8a  8a  8a
      │<span class="sgr90">  A    B    E    A    B    E   A   E   T   A   E   T
──────┼──────────────────────────────────────────────────────
 W₁W₂ │</span><span class="sgr94">  2    2    2    1    1    4   ·   ·   2   1   2   1
 W₃W₄ │  1    1    4    2    2    2   1   2   1   ·   ·   2
 L₁L₂ │  1    1    2    1    1    2   1   ·   1   1   ·   1
 L₃L₃ │  1    1    2    1    1    2   ·   1   1   ·   1   1
 X₁   │  2    1    ·    ·    1    2   ·   ·   1   1   2   ·
 X₂   │  1    2    ·    1    ·    2   ·   ·   1   1   2   ·
 X₃   │  ·    1    2    2    1    ·   1   2   ·   ·   ·   1
 X₄   │  1    ·    2    1    2    ·   1   2   ·   ·   ·   1
 X₅   │  1    1    4    1    1    4   ·   ·   2   ·   ·   2
 Γ₁   │  1    ·    ·    1    ·    ·   1   ·   ·   1   ·   ·
 Γ₂   │  ·    1    ·    ·    1    ·   1   ·   ·   1   ·   ·
 Γ₃   │  1    1    ·    1    1    ·   ·   2   ·   ·   2   ·
 Γ₄   │  ·    1    2    ·    1    2   ·   ·   1   ·   ·   1
 Γ₅   │  1    ·    2    1    ·    2   ·   ·   1   ·   ·   1
──────┼──────────────────────────────────────────────────────
 μ    │</span><span class="sgr93">  6    6   12    6    6   12   2   4   6   2   4   6
──────┴──────────────────────────────────────────────────────
</span></span></code></pre><p>which returns a <code>Collection{NewBandRep{3}}</code>, whose iterants are <code>NewBandRep{3}</code>s. We can inspect any individual vector in <code>brs</code>, e.g.:</p><pre><code class="language-julia hljs">brs[10] # obtain the EBR induced by Wyckoff position 8a with irrep A</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">14-irrep NewBandRep{3}:
 (<span class="sgr1">8a</span>|<span class="sgr1">A</span>): [<span class="sgr94">W₁W₂</span>, L₁L₂, <span class="sgr94">X₁+X₂</span>, Γ₁+Γ₂]<span class="sgr90"> (2 bands)</span></code></pre><p>Currently, <code>calc_bandreps</code> can only treat spinless systems; if spinful systems are required, use <code>bandreps</code>. The presence or absence of time-reversal symmetry can be controlled with the keyword arguments <code>timereversal</code> (default, <code>true</code>). By default, only maximal <strong>k</strong>-points are included in the projection onto little group irreps; additional <strong>k</strong>-points (e.g., high-symmetry lines and planes) can be obtained by setting the keyword argument <code>allpaths = true</code> (default, <code>false</code>).</p><p>A set of EBRs can be used as the basis for several analyses. For instance, we can use the EBRs to compute the symmetry indicator group, summarizing the distinct topological classes identifiable from symmetry. Crystalline.jl implements <a href="../api/#Crystalline.indicator_group-Tuple{Smith}"><code>indicator_group</code></a> and <a href="../api/#Crystalline.indicator_group_as_string-Tuple{AbstractVector{&lt;:Integer}}"><code>indicator_group_as_string</code></a>, which uses the Smith normal form&#39;s elementary factors to this end:</p><pre><code class="language-julia hljs">indicator_group_as_string(brs)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;Z₁&quot;</code></pre><p>Which demonstrates that the symmetry indicator group of spinless particles with time-reversal symmetry in space group 219 is trivial.</p><pre><code class="language- hljs">indicator_group
indicator_group_as_string</code></pre><h2 id="Topological-analysis"><a class="docs-heading-anchor" href="#Topological-analysis">Topological analysis</a><a id="Topological-analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Topological-analysis" title="Permalink"></a></h2><p>An EBR basis can also be used to analyze <a href="../api/#Crystalline.SymmetryVector"><code>SymmetryVector</code></a>s, including their topology and whether they fulfil compatibility relations.</p><pre><code class="language- hljs">iscompatible
calc_topology
symmetry_indicators</code></pre><h2 id="Associated-bases"><a class="docs-heading-anchor" href="#Associated-bases">Associated bases</a><a id="Associated-bases-1"></a><a class="docs-heading-anchor-permalink" href="#Associated-bases" title="Permalink"></a></h2><p>The <a href="https://github.com/thchr/SymmetryBases.jl"><code>SymmetryBases.jl</code></a> package provides additional tools to analyze fragile topology and to compute associated Hilbert bases.</p><h2 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Crystalline.calc_bandreps-bandreps" href="#Crystalline.calc_bandreps-bandreps"><code>Crystalline.calc_bandreps</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_bandreps(sgnum::Integer, Dᵛ::Val{D}=Val(3);
              timereversal::Bool=true,
              allpaths::Bool=false,
              explicitly_real::Bool=timereversal)</code></pre><p>Compute the band representations of space group <code>sgnum</code> in dimension <code>D</code>, returning a <code>BandRepSet</code>.</p><p><strong>Keyword arguments</strong></p><ul><li><code>timereversal</code> (default, <code>true</code>): whether the irreps used to induce the band representations are assumed to be time-reversal invariant (i.e., are coreps, see  <a href="../api/#Crystalline.realify-Tuple{AbstractDict{&lt;:AbstractString, &lt;:AbstractVector{&lt;:Crystalline.AbstractIrrep}}}"><code>realify</code></a>).</li><li><code>allpaths</code> (default, <code>false</code>): whether the band representations are projected to all distinct <strong>k</strong>-points returned by <code>lgirreps</code> (<code>allpaths = false</code>), including high-symmetry <strong>k</strong>-lines and -plane, or only to the maximal <strong>k</strong>-points (<code>allpaths = true</code>), i.e., just to high-symmetry points.</li><li><code>explicitly_real</code> (default, <code>timereversal</code>): whether, if <code>timereversal = true</code>, to ensure that the site symmetry irreps accompanying the band representations are chosen to be explicitly real (or &quot;physically&quot; real; see <a href="../api/#Crystalline.physical_realify-Tuple{Union{PGIrrep, SiteIrrep}}"><code>physical_realify</code></a>). This is helpful for subsequent analysis of the action of time-reversal symmetry.</li></ul><p><strong>Notes</strong></p><p>All band representations associated with maximal Wyckoff positions are returned,  irregardless of whether they are elementary (i.e., no regard is made to whether the band representation is &quot;composite&quot;). As such, the returned band representations generally are a superset of the set of elementary band representations (and so contain all elementary band representations).</p><p><strong>Implementation</strong></p><p>The implementation is based on Cano, Bradlyn, Wang, Elcoro, et al., <a href="https://doi.org/10.1103/PhysRevB.97.035139">Phys. Rev. B <strong>97</strong>, 035139 (2018)</a>, Sections II.C-D.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/efb934f50b75eb88f33f2dda28a59d4cabeed0cf/src/calc_bandreps.jl#L251-L283">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Crystalline.bandreps-bandreps" href="#Crystalline.bandreps-bandreps"><code>Crystalline.bandreps</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bandreps(sgnum::Integer, D::Integer=3; 
         allpaths::Bool=false, spinful::Bool=false, timereversal::Bool=true)</code></pre><p>Returns the elementary band representations (EBRs) as a <code>BandRepSet</code> for space group <code>sgnum</code> and dimension <code>D</code>.</p><p><strong>Keyword arguments</strong></p><ul><li><code>allpaths</code>: include a minimal sufficient set (<code>false</code>, default) or all (<code>true</code>)              <strong>k</strong>-vectors. </li><li><code>spinful</code>: single- (<code>false</code>, default) or double-valued (<code>true</code>) irreps, as appropriate for            spinless and spinful particles, respectively. Only available for <code>D=3</code>.</li><li><code>timereversal</code>: assume presence (<code>true</code>, default) or absence (<code>false</code>) of time-reversal                 symmetry.</li></ul><p><strong>References</strong></p><p>3D EBRs are obtained from the Bilbao Crystallographic Server&#39;s  <a href="http://www.cryst.ehu.es/cgi-bin/cryst/programs/bandrep.pl">BANDREP program</a>; please reference the original research papers noted there if used in published work.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/efb934f50b75eb88f33f2dda28a59d4cabeed0cf/src/bandrep.jl#L94-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Crystalline.indicator_group-bandreps" href="#Crystalline.indicator_group-bandreps"><code>Crystalline.indicator_group</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">indicator_group(F::Smith) -&gt; Any
</code></pre><p>Return the symmetry indicator group <span>$X^{\text{BS}}$</span> associated with an input set of band representations <code>brs</code> (or Smith decomposition thereof, <code>F</code>), i.e., return the the nontrivial (i.e., ≠ {0,1}) elementary factors of the Smith normal form of the band representation matrix. The return value is a <code>Vector{Int}</code> containing the nontrivial factors. If no nontrivial factors exists, the return value is an empty <code>Vector{Int}</code>.</p><p>See also <a href="../api/#Crystalline.indicator_group_as_string-Tuple{AbstractVector{&lt;:Integer}}"><code>indicator_group_as_string</code></a> for a formatted string version.</p><p><strong>Understanding</strong></p><p>The symmetry indicator group answers the question &quot;what direct product of <span>$\mathbb{Z}_n$</span> groups is the the quotient group <span>$X^{\text{BS}} = \{\text{BS}\}/\{\text{AI}\}$</span> isomorphic to?&quot; (see e.g., <a href="https://doi.org/10.1038/s41467-017-00133-2">Po, Watanabe, &amp; Vishwanath, Nature Commun. <strong>8</strong>, 50 (2017)</a> for more information).</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; brs = calc_bandreps(2, Val(3));

julia&gt; indicator_group(brs)
4-element Vector{Int64}:
 2
 2
 2
 4</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/efb934f50b75eb88f33f2dda28a59d4cabeed0cf/src/tqc_analysis.jl#L186">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Crystalline.indicator_group_as_string-bandreps" href="#Crystalline.indicator_group_as_string-bandreps"><code>Crystalline.indicator_group_as_string</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">indicator_group_as_string(
    nontriv_Λ::AbstractVector{&lt;:Integer}
)
</code></pre><p>Return the symmetry indicator group <span>$X^{\text{BS}}$</span> as a formatted string (i.e.,  as <code>&quot;Zᵢ×Zⱼ×…&quot;</code>). See also <a href="../api/#Crystalline.indicator_group-Tuple{Smith}"><code>indicator_group</code></a> for a vector representation.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; brs = calc_bandreps(2, Val(3));

julia&gt; indicator_group_as_string(brs)
&quot;Z₂×Z₂×Z₂×Z₄&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/efb934f50b75eb88f33f2dda28a59d4cabeed0cf/src/tqc_analysis.jl#L231">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Crystalline.basisdim-bandreps" href="#Crystalline.basisdim-bandreps"><code>Crystalline.basisdim</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">basisdim(brs::BandRepSet) --&gt; Int</code></pre><p>Return the dimension of the (linearly independent parts) of a band representation set. This is <span>$d^{\text{bs}} = d^{\text{ai}}$</span> in the notation of <a href="https://doi.org/10.1038/s41467-017-00133-2">Po, Watanabe, &amp; Vishwanath, Nature Commun. <strong>8</strong>, 50 (2017)</a>, or  equivalently, the rank of <code>stack(brs)</code> over the ring of integers. This is the number of linearly independent basis vectors that span the expansions of a band structure viewed as symmetry data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/thchr/Crystalline.jl/blob/efb934f50b75eb88f33f2dda28a59d4cabeed0cf/src/bandrep.jl#L128-L137">source</a></section></article><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>Note that the band representations returned by <a href="../api/#Crystalline.calc_bandreps-Union{Tuple{Integer}, Tuple{D}, Tuple{Integer, Val{D}}} where D"><code>calc_bandreps</code></a> need not be <em>elementary</em>; i.e., a band representation returned by <code>calc_bandreps</code> may be &quot;composite&quot; in the &quot;exceptional&quot; sense defined in the original topological quantum chemistry papers (e.g., https://arxiv.org/pdf/1709.01935). The inclusion of a non-elementary band representation into a set of elementary band representations makes no difference for the purposes of analyzing band topology or band connectivity using this set, however. I.e., the set of band representations returned by <code>calc_bandreps</code> is usually equivalent to the set returned by <code>bandreps</code> (referencing the Bilbao Crystallographic Server tables), and is otherwise a strict superset. For the sake of simplicity, we will colloquially refer to the band representations returned by <code>calc_bandreps</code> as EBRs, even though the set may technically contain non-elementary band representations.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../bravais/">« Bravais types &amp; bases</a><a class="docs-footer-nextpage" href="../lattices/">Lattices »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Friday 16 May 2025 21:10">Friday 16 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
