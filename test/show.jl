using Crystalline, Test
using LinearAlgebra: dot

# ---------------------------------------------------------------------------------------- #
# test print with nicely printed diff on failures (from https://github.com/invenia/PkgTemplates.jl/blob/master/test/runtests.jl)
using DeepDiffs: deepdiff
function print_diff(a, b)
    old = Base.have_color
    @eval Base have_color = true
    try
        println(deepdiff(a, b))
    finally
        @eval Base have_color = $old
    end
end

function test_show(expected::AbstractString, observed::AbstractString)
    if expected == observed
        @test true
    else
        print_diff(expected, observed)
        @test :expected == :observed
    end
end
test_tp_show(v, observed::AbstractString) = test_show(repr(MIME"text/plain"(), v), observed)

# ---------------------------------------------------------------------------------------- #

@testset "`show` overloads" begin
# -------------------------------
# DirectBasis
# -------------------------------
Rs = DirectBasis([1.0,0.0,0.0], [0.0,1.0,0.0], [0.0,0.0,1.0]) # cubic
str = """
      DirectBasis{3} (cubic):
       [1.0, 0.0, 0.0]
       [0.0, 1.0, 0.0]
       [0.0, 0.0, 1.0]"""
test_tp_show(Rs, str)

Rs = DirectBasis([1,0,0], [0,1,0], [0,0,1]) # cubic with Int coordinate value type
str = """
      DirectBasis{3, Int64} (cubic):
       [1, 0, 0]
       [0, 1, 0]
       [0, 0, 1]"""
test_tp_show(Rs, str)

Rs = DirectBasis([1,0,0], [-0.5, âˆš(3)/2, 0.0], [0, 0, 1.5]) # hexagonal
str = """
      DirectBasis{3} (hexagonal):
       [1.0, 0.0, 0.0]
       [-0.5, 0.8660254037844386, 0.0]
       [0.0, 0.0, 1.5]"""
test_tp_show(Rs, str)
Rsâ€² = directbasis(183, Val(3))
@test Rs[1] â‰ˆ Rsâ€²[1] && Rs[2] â‰ˆ Rsâ€²[2]
@test abs(dot(Rs[1], Rsâ€²[3])) < 1e-14
@test abs(dot(Rs[2], Rsâ€²[3])) < 1e-14
@test abs(dot(Rs[3], Rsâ€²[3])) > 1e-1

Gs = dualbasis(Rs)
str = """
      ReciprocalBasis{3} (hexagonal):
       [6.283185307179586, 3.6275987284684357, -0.0]
       [0.0, 7.255197456936871, 0.0]
       [0.0, -0.0, 4.1887902047863905]"""
test_tp_show(Gs, str)

# test printing for unitful bases; don't clobber with big type before "[...]"
using Unitful
Rs = DirectBasis([1.0, 0, 0]*1u"â„«" , [-0.5, sqrt(3)/2, 0]*1u"â„«" ,   [0, 0, 1.25]*1u"â„«")
str = """
      DirectBasis{3, Quantity{Float64, ğ‹, Unitful.FreeUnits{(Ã…,), ğ‹, nothing}}} (hexagonal):
       [1.0 Ã…, 0.0 Ã…, 0.0 Ã…]
       [-0.5 Ã…, 0.8660254037844386 Ã…, 0.0 Ã…]
       [0.0 Ã…, 0.0 Ã…, 1.25 Ã…]"""
test_tp_show(Rs, str)

if !Sys.isapple()
    # don't test on Apple, since Unitful prints "^-1" as "â»Â¹" there
    # (see https://github.com/PainterQubits/Unitful.jl/pull/446#issuecomment-2770636653)
    Gs = dualbasis(Rs)
    str = """
          ReciprocalBasis{3, Quantity{Float64, ğ‹^-1, Unitful.FreeUnits{(Ã…^-1,), ğ‹^-1, nothing}}} (hexagonal):
          [6.283185307179586 Ã…^-1, 3.6275987284684357 Ã…^-1, -0.0 Ã…^-1]
          [0.0 Ã…^-1, 7.255197456936871 Ã…^-1, 0.0 Ã…^-1]
          [0.0 Ã…^-1, -0.0 Ã…^-1, 5.026548245743669 Ã…^-1]"""
    test_tp_show(Gs, str)
end

# -------------------------------
# SymOperation
# -------------------------------
str = """
      1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ (x,y,z)
       â”Œ 1  0  0 â•· 0 â”
       â”‚ 0  1  0 â”† 0 â”‚
       â”” 0  0  1 â•µ 0 â”˜"""
test_tp_show(S"x,y,z", str)

str = """
      {-3â‚‹â‚â‚‹â‚â‚âº|0,Â½,â…“} â”€â”€â”€â”€â”€â”€â”€â”€ (z,-x+1/2,y+1/3)
       â”Œ  0  0  1 â•·   0 â”
       â”‚ -1  0  0 â”† 1/2 â”‚
       â””  0  1  0 â•µ 1/3 â”˜"""
test_tp_show(S"z,-x+1/2,y+1/3", str)

str = """
      3â» â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ (-x+y,-x)
       â”Œ -1  1 â•· 0 â”
       â”” -1  0 â•µ 0 â”˜"""
test_tp_show(S"y-x,-x", str)

str = """
      3-element Vector{SymOperation{3}}:
       1
       2â‚€â‚â‚
       {3â‚â‚â‚â»|0,0,â…“}"""
test_tp_show([S"x,y,z", S"-x,z,y", S"y,z,x+1/3"], str)

str = """
      4Ã—4 Matrix{SymOperation{3}}:
       1     2â‚€â‚€â‚  2â‚€â‚â‚€  2â‚â‚€â‚€
       2â‚€â‚€â‚  1     2â‚â‚€â‚€  2â‚€â‚â‚€
       2â‚€â‚â‚€  2â‚â‚€â‚€  1     2â‚€â‚€â‚
       2â‚â‚€â‚€  2â‚€â‚â‚€  2â‚€â‚€â‚  1"""
sg = spacegroup(16)
test_tp_show(sg .* permutedims(sg), str)

# -------------------------------
# MultTable
# -------------------------------
str = """
      6Ã—6 MultTable{SymOperation{3}}:
      â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
             â”‚     1  3â‚€â‚€â‚âº  3â‚€â‚€â‚â»   2â‚€â‚€â‚  6â‚€â‚€â‚â»  6â‚€â‚€â‚âº
      â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           1 â”‚     1  3â‚€â‚€â‚âº  3â‚€â‚€â‚â»   2â‚€â‚€â‚  6â‚€â‚€â‚â»  6â‚€â‚€â‚âº
       3â‚€â‚€â‚âº â”‚ 3â‚€â‚€â‚âº  3â‚€â‚€â‚â»      1  6â‚€â‚€â‚â»  6â‚€â‚€â‚âº   2â‚€â‚€â‚
       3â‚€â‚€â‚â» â”‚ 3â‚€â‚€â‚â»      1  3â‚€â‚€â‚âº  6â‚€â‚€â‚âº   2â‚€â‚€â‚  6â‚€â‚€â‚â»
        2â‚€â‚€â‚ â”‚  2â‚€â‚€â‚  6â‚€â‚€â‚â»  6â‚€â‚€â‚âº      1  3â‚€â‚€â‚âº  3â‚€â‚€â‚â»
       6â‚€â‚€â‚â» â”‚ 6â‚€â‚€â‚â»  6â‚€â‚€â‚âº   2â‚€â‚€â‚  3â‚€â‚€â‚âº  3â‚€â‚€â‚â»      1
       6â‚€â‚€â‚âº â”‚ 6â‚€â‚€â‚âº   2â‚€â‚€â‚  6â‚€â‚€â‚â»  3â‚€â‚€â‚â»      1  3â‚€â‚€â‚âº
      â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      """
test_tp_show(MultTable(pointgroup("6")), str)

str = """
      4Ã—4 MultTable{SymOperation{3}}:
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                    â”‚            1  {2â‚€â‚â‚€|0,0,Â½}            -1  {mâ‚€â‚â‚€|0,0,Â½}
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                  1 â”‚            1  {2â‚€â‚â‚€|0,0,Â½}            -1  {mâ‚€â‚â‚€|0,0,Â½}
       {2â‚€â‚â‚€|0,0,Â½} â”‚ {2â‚€â‚â‚€|0,0,Â½}             1  {mâ‚€â‚â‚€|0,0,Â½}            -1
                 -1 â”‚           -1  {mâ‚€â‚â‚€|0,0,Â½}             1  {2â‚€â‚â‚€|0,0,Â½}
       {mâ‚€â‚â‚€|0,0,Â½} â”‚ {mâ‚€â‚â‚€|0,0,Â½}            -1  {2â‚€â‚â‚€|0,0,Â½}             1
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      """
test_tp_show(MultTable(spacegroup(13)), str)

# -------------------------------
# KVec
# -------------------------------
for v in (KVec, RVec)
    test_tp_show(v("0,0,.5+u"), "[0, 0, 1/2+Î±]")
    test_tp_show(v("1/2+Î±,Î²+Î±,1/4"), "[1/2+Î±, Î±+Î², 1/4]")
    test_tp_show(v("Î²,-Î±"), "[Î², -Î±]")
    @test repr(MIME"text/plain"(), v("y,Î³,u")) == repr(MIME"text/plain"(), v("Î²,w,x"))
end

# -------------------------------
# AbstractGroup
# -------------------------------
str = """
      PointGroup{3} â‹•21 (6) with 6 operations:
       1
       3â‚€â‚€â‚âº
       3â‚€â‚€â‚â»
       2â‚€â‚€â‚
       6â‚€â‚€â‚â»
       6â‚€â‚€â‚âº"""
test_tp_show(pointgroup("6", Val(3)), str)

str = """
      SpaceGroup{3} â‹•213 (P4â‚32) with 24 operations:
       1
       {2â‚€â‚€â‚|Â½,0,Â½}
       {2â‚€â‚â‚€|0,Â½,Â½}
       {2â‚â‚€â‚€|Â½,Â½,0}
       3â‚â‚â‚âº
       {3â‚‹â‚â‚â‚‹â‚âº|Â½,Â½,0}
       {3â‚‹â‚â‚â‚â»|Â½,0,Â½}
       {3â‚‹â‚â‚‹â‚â‚âº|0,Â½,Â½}
       3â‚â‚â‚â»
       {3â‚‹â‚â‚â‚âº|0,Â½,Â½}
       {3â‚‹â‚â‚‹â‚â‚â»|Â½,Â½,0}
       {3â‚‹â‚â‚â‚‹â‚â»|Â½,0,Â½}
       {2â‚â‚â‚€|Â¾,Â¼,Â¼}
       {2â‚‹â‚â‚â‚€|Â¾,Â¾,Â¾}
       {4â‚€â‚€â‚â»|Â¼,Â¼,Â¾}
       {4â‚€â‚€â‚âº|Â¼,Â¾,Â¼}
       {4â‚â‚€â‚€â»|Â¾,Â¼,Â¼}
       {2â‚€â‚â‚|Â¼,Â¾,Â¼}
       {2â‚€â‚‹â‚â‚|Â¾,Â¾,Â¾}
       {4â‚â‚€â‚€âº|Â¼,Â¼,Â¾}
       {4â‚€â‚â‚€âº|Â¾,Â¼,Â¼}
       {2â‚â‚€â‚|Â¼,Â¼,Â¾}
       {4â‚€â‚â‚€â»|Â¼,Â¾,Â¼}
       {2â‚‹â‚â‚€â‚|Â¾,Â¾,Â¾}"""
test_tp_show(spacegroup(213, Val(3)), str)

str = """
      SiteGroup{2} â‹•17 (p6mm) at 2b = [1/3, 2/3] with 6 operations:
       1
       {3âº|1,1}
       {3â»|0,1}
       {mâ‚â‚|1,1}
       mâ‚â‚€
       {mâ‚€â‚|0,1}"""
sg = spacegroup(17,Val(2))
wps = wyckoffs(17, Val(2))
test_tp_show(sitegroup(sg, wps[end-1]), str)

# -------------------------------
# LGIrrep
# -------------------------------
str = """
4-element Collection{LGIrrep{3}} for â‹•16 (P222) at Î“ = [0, 0, 0]:
Î“â‚â”Œ    1: 1
  â”œ 2â‚â‚€â‚€: 1
  â”œ 2â‚€â‚â‚€: 1
  â”” 2â‚€â‚€â‚: 1

Î“â‚‚â”Œ    1: 1
  â”œ 2â‚â‚€â‚€: -1
  â”œ 2â‚€â‚â‚€: -1
  â”” 2â‚€â‚€â‚: 1

Î“â‚ƒâ”Œ    1: 1
  â”œ 2â‚â‚€â‚€: 1
  â”œ 2â‚€â‚â‚€: -1
  â”” 2â‚€â‚€â‚: -1

Î“â‚„â”Œ    1: 1
  â”œ 2â‚â‚€â‚€: -1
  â”œ 2â‚€â‚â‚€: 1
  â”” 2â‚€â‚€â‚: -1"""
test_tp_show(lgirreps(16)["Î“"], str)

str = """
4-element Collection{LGIrrep{3}}:
 #undef
 #undef
 #undef
 #undef"""
test_tp_show(similar(lgirreps(16)["Î“"]), str)

str = """
Î“â‚…â”Œ             1: â¡ 1  0 â¤
  â”‚                â£ 0  1 â¦
  â”œ  {2â‚â‚€â‚€|0,Â½,Â¼}: â¡ 1   0 â¤
  â”‚                â£ 0  -1 â¦
  â”œ  {2â‚€â‚â‚€|0,Â½,Â¼}: â¡ -1  0 â¤
  â”‚                â£  0  1 â¦
  â”œ          2â‚€â‚€â‚: â¡ -1   0 â¤
  â”‚                â£  0  -1 â¦
  â”œ        -4â‚€â‚€â‚âº: â¡  0  1 â¤
  â”‚                â£ -1  0 â¦
  â”œ        -4â‚€â‚€â‚â»: â¡ 0  -1 â¤
  â”‚                â£ 1   0 â¦
  â”œ  {mâ‚â‚â‚€|0,Â½,Â¼}: â¡  0  -1 â¤
  â”‚                â£ -1   0 â¦
  â”œ {mâ‚‹â‚â‚â‚€|0,Â½,Â¼}: â¡ 0  1 â¤
  â””                â£ 1  0 â¦"""
test_tp_show(lgirreps(122)["Î“"][end], str)

str = """
Î“â‚†â”Œ     1: 1
  â”œ  2â‚€â‚€â‚: -1
  â”œ 3â‚€â‚€â‚âº: exp(-0.6667iÏ€)
  â”œ 3â‚€â‚€â‚â»: exp(0.6667iÏ€)
  â”œ 6â‚€â‚€â‚âº: exp(-0.3333iÏ€)
  â”” 6â‚€â‚€â‚â»: exp(0.3333iÏ€)"""
test_tp_show(lgirreps(168)["Î“"][end], str)

@test repr(lgirreps(168)["Î“"]) == "[Î“â‚, Î“â‚‚, Î“â‚ƒ, Î“â‚„, Î“â‚…, Î“â‚†] (Î“ = [0, 0, 0])"

# -------------------------------
# PGIrrep
# -------------------------------
str = """
Î“â‚„Î“â‚†â”Œ     1: â¡ 1  0 â¤
    â”‚        â£ 0  1 â¦
    â”œ 3â‚€â‚€â‚âº: â¡ -0.5+0.866im             0 â¤
    â”‚        â£            0  -0.5-0.866im â¦
    â”œ 3â‚€â‚€â‚â»: â¡ -0.5-0.866im             0 â¤
    â”‚        â£            0  -0.5+0.866im â¦
    â”œ  2â‚€â‚€â‚: â¡ -1   0 â¤
    â”‚        â£  0  -1 â¦
    â”œ 6â‚€â‚€â‚â»: â¡ 0.5-0.866im            0 â¤
    â”‚        â£           0  0.5+0.866im â¦
    â”œ 6â‚€â‚€â‚âº: â¡ 0.5+0.866im            0 â¤
    â””        â£           0  0.5-0.866im â¦"""
pgirs = pgirreps("6")
pgirsâ€² = realify(pgirs)
test_tp_show(pgirsâ€²[end], str)
@test summary(pgirs) == "6-element Collection{PGIrrep{3}}"
@test summary(pgirsâ€²) == "4-element Collection{PGIrrep{3}}"

@test repr(realify(pgirreps("4/m"))) == "[Î“â‚âº, Î“â‚â», Î“â‚‚âº, Î“â‚‚â», Î“â‚ƒâºÎ“â‚„âº, Î“â‚ƒâ»Î“â‚„â»]"
@test repr(realify(pgirreps("4/m"; mulliken=true))) == "[Ag, Aáµ¤, Bg, Báµ¤, Eg, Eáµ¤]"

# -------------------------------
# CharacterTable
# -------------------------------
str = """
CharacterTable{3} for â‹•21 (6):
â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       â”‚ Î“â‚  Î“â‚‚  Î“â‚ƒÎ“â‚…  Î“â‚„Î“â‚†
â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     1 â”‚  1   1     2     2
 3â‚€â‚€â‚âº â”‚  1   1    -1    -1
 3â‚€â‚€â‚â» â”‚  1   1    -1    -1
  2â‚€â‚€â‚ â”‚  1  -1     2    -2
 6â‚€â‚€â‚â» â”‚  1  -1    -1     1
 6â‚€â‚€â‚âº â”‚  1  -1    -1     1
â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
"""
test_tp_show(characters(pgirsâ€²), str)

str = """
CharacterTable{3} for â‹•230 (Ia-3d) at P = [1/2, 1/2, 1/2]:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                 â”‚     Pâ‚      Pâ‚‚    Pâ‚ƒ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
               1 â”‚      2       2     4
    {2â‚â‚€â‚€|0,0,Â½} â”‚      0       0     0
    {2â‚€â‚â‚€|Â½,0,0} â”‚      0       0     0
    {2â‚€â‚€â‚|0,Â½,0} â”‚      0       0     0
           3â‚â‚â‚âº â”‚     -1      -1     1
           3â‚â‚â‚â» â”‚     -1      -1     1
  {3â‚‹â‚â‚â‚âº|Â½,0,0} â”‚   -1im    -1im   1im
  {3â‚‹â‚â‚â‚â»|0,Â½,0} â”‚    1im     1im  -1im
 {3â‚‹â‚â‚â‚‹â‚â»|0,Â½,0} â”‚   -1im    -1im   1im
 {3â‚‹â‚â‚â‚‹â‚âº|0,0,Â½} â”‚    1im     1im  -1im
 {3â‚‹â‚â‚‹â‚â‚â»|0,0,Â½} â”‚   -1im    -1im   1im
 {3â‚‹â‚â‚‹â‚â‚âº|Â½,0,0} â”‚    1im     1im  -1im
  {-4â‚â‚€â‚€âº|Â¼,Â¼,Â¾} â”‚ -1+1im   1-1im     0
  {-4â‚â‚€â‚€â»|Â¾,Â¼,Â¼} â”‚  1-1im  -1+1im     0
  {-4â‚€â‚â‚€âº|Â¾,Â¼,Â¼} â”‚ -1+1im   1-1im     0
  {-4â‚€â‚â‚€â»|Â¼,Â¾,Â¼} â”‚  1-1im  -1+1im     0
  {-4â‚€â‚€â‚âº|Â¼,Â¾,Â¼} â”‚ -1+1im   1-1im     0
  {-4â‚€â‚€â‚â»|Â¼,Â¼,Â¾} â”‚  1-1im  -1+1im     0
    {mâ‚â‚â‚€|Â¾,Â¼,Â¼} â”‚      0       0     0
   {mâ‚‹â‚â‚â‚€|Â¼,Â¼,Â¼} â”‚      0       0     0
    {mâ‚â‚€â‚|Â¼,Â¼,Â¾} â”‚      0       0     0
   {mâ‚‹â‚â‚€â‚|Â¼,Â¼,Â¼} â”‚      0       0     0
    {mâ‚€â‚â‚|Â¼,Â¾,Â¼} â”‚      0       0     0
   {mâ‚€â‚‹â‚â‚|Â¼,Â¼,Â¼} â”‚      0       0     0
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
"""
test_tp_show(characters(lgirreps(230)["P"]), str)

# -------------------------------
# BandRepSet and BandRep
# -------------------------------
brs = bandreps(42, 3)
str = """
BandRepSet (â‹•42): 6 BandReps, sampling 17 LGIrreps (spin-1 w/ TR)
â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚ 4a  4a  4a  4a  8b  8b
    â”‚ Aâ‚  Aâ‚‚  Bâ‚  Bâ‚‚  A   B
â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 Î“â‚ â”‚ 1   Â·   Â·   Â·   1   Â·
 Î“â‚‚ â”‚ Â·   1   Â·   Â·   1   Â·
 Î“â‚ƒ â”‚ Â·   Â·   Â·   1   Â·   1
 Î“â‚„ â”‚ Â·   Â·   1   Â·   Â·   1
 Tâ‚ â”‚ 1   Â·   Â·   Â·   Â·   1
 Tâ‚‚ â”‚ Â·   1   Â·   Â·   Â·   1
 Tâ‚ƒ â”‚ Â·   Â·   Â·   1   1   Â·
 Tâ‚„ â”‚ Â·   Â·   1   Â·   1   Â·
 Yâ‚ â”‚ 1   Â·   Â·   Â·   Â·   1
 Yâ‚‚ â”‚ Â·   1   Â·   Â·   Â·   1
 Yâ‚ƒ â”‚ Â·   Â·   Â·   1   1   Â·
 Yâ‚„ â”‚ Â·   Â·   1   Â·   1   Â·
 Zâ‚ â”‚ 1   Â·   Â·   Â·   1   Â·
 Zâ‚‚ â”‚ Â·   1   Â·   Â·   1   Â·
 Zâ‚ƒ â”‚ Â·   Â·   Â·   1   Â·   1
 Zâ‚„ â”‚ Â·   Â·   1   Â·   Â·   1
 Lâ‚ â”‚ 1   1   1   1   2   2
â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 Î¼  â”‚ 1   1   1   1   2   2
â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  KVecs: Î“, T, Y, Z, L"""
test_tp_show(brs, str)

test_tp_show(brs[1],   "1-band BandRep (Aâ‚â†‘G at 4a):\n [Î“â‚, Tâ‚, Yâ‚, Zâ‚, Lâ‚]")
test_tp_show(brs[end], "2-band BandRep (Bâ†‘G at 8b):\n [Î“â‚ƒ+Î“â‚„, Tâ‚+Tâ‚‚, Yâ‚+Yâ‚‚, Zâ‚ƒ+Zâ‚„, 2Lâ‚]")

str = "[(8b|A), (8b|B), (4a|Aâ‚), (4a|Aâ‚‚), (4a|Bâ‚‚), (4a|Bâ‚)]"
@test repr(calc_bandreps(42, Val(3))) == str

end # @testset